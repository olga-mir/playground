apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: control-plane-cluster
  namespace: flux-system
  annotations:
    # TODO: using different key to understand better how it works.
    event.toolkit.fluxcd.io/cluster-name: "control-plane"
spec:
  interval: 5m
  path: "./bootstrap/kind/crossplane/clusters"
  prune: true
  sourceRef:
    kind: GitRepository
    name: flux-system
    namespace: flux-system
  targetNamespace: gkecluster-control-plane
  healthChecks:
    - apiVersion: platform.tornado-demo.io/v1alpha1
      kind: GKECluster
      name: control-plane-cluster
      namespace: gkecluster-control-plane
  timeout: 15m
  #dependsOn: # TODO
  #  - name: crossplane-providers
